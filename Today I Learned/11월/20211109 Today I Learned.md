# 20211109 Today I Learned

# π― μ¤λμ λ©ν‘

- [x]  μ¤ν”„λ§ μ‹νλ¦¬ν‹° κ³µλ¶€
- [x]  ν”„λ΅μ νΈ λ΅κ·ΈμΈ κµ¬ν„

# π“– μ¤λ λ¬΄μ¨ μΌμ„ ν–λ‚?

 μ¤ν”„λ§ μ‹νλ¦¬ν‹°λ¥Ό μ‚¬μ©ν•΄ λ΅κ·ΈμΈ κΈ°λ¥μ„ κµ¬ν„ν–λ‹¤. μ§€κΈκΉμ§€ λλ‚€κ±Έλ΅λ” μ„Έν…ν•λ” λ¶€λ¶„μ΄ λ€λ‹¤μ μΈ κ²ƒ κ°™λ‹¤. μ•„λ¬΄λλ„ 5μ‹κ°„μ§λ¦¬ μΈκ°• ν•λ‚ λ“¤μ€ κ±Έλ΅λ” μΆ€ λ¨μλ€ λ¶€λ¶„μ΄ μλ” κ²ƒ κ°™μ•„ κ³µμ‹ λ¬Έμ„λ‚ λ‹¤λ¥Έ λΈ”λ΅κ·Έλ“¤μ„ μ°Έκ³ ν•΄μ„ κ³µλ¶€λ¥Ό λ” ν•΄μ•Ό ν•  λ“― ν•λ‹¤.

# π€ μ¤λμ μ‚°μ¶λ¬Ό

μΈκ°€λ¥Ό ν•λ” λ°©λ²•μ€ ν¬κ² λ‹¤μ μ„Έ κ°€μ§€λ΅ λ‚λ‰λ‹¤.

1. Basic Auth
2. Form Based Authentication
3. JWT Token Verify

μ΄ μ¤‘μ—μ„ μ„μ λ‘ κ°€μ§€μΈ Basic Authμ™€ Form Based Authenticationμ„ μ •λ¦¬ν•λ ¤κ³  ν•λ‹¤.

## π“— Basic Auth

![Untitled 1](https://user-images.githubusercontent.com/19809346/140945578-9b252233-4595-478e-abd5-2339a5673ab0.png)

 λ‹¤μκ³Ό κ°™μ€ μμ„λ΅ μ§„ν–‰λλ‹¤.

1. ν΄λΌμ΄μ–ΈνΈκ°€ μΈκ°€(authorization)λ¥Ό λ°›μ§€ μ•κ³  μ„λ²„μ—κ² μ›ν•λ” μμ›μ— λ€ν•΄ GET requestλ¥Ό λ³΄λ‚Έλ‹¤.
2. μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈκ°€ μΈκ°€λ¥Ό λ°›μ§€ μ•μ€ μ‚¬μ©μμ΄λ―€λ΅ 401 Unauthorized Http μƒνƒ λ©”μ‹μ§€λ¥Ό λ³΄λ‚Έλ‹¤.
3. ν΄λΌμ΄μ–ΈνΈκ°€ Basic64λ΅ μ•”νΈν™”ν• usernameκ³Ό passwordλ¥Ό 'request header'μ— ν¬ν•¨ν•΄ μ„λ²„μ—κ² μ „μ†΅ν•λ‹¤
4. ν΄λΌμ΄μ–ΈνΈκ°€ λ³΄λ‚Έ μ •λ³΄κ°€ μ¬λ°”λ¥Έ μ •λ³΄λΌλ©΄ μ„λ²„λ” 200 ok Http μƒνƒ λ©”μ‹μ§€λ¥Ό λ³΄λ‚Έλ‹¤.
5. κ·Έ λ’¤μ— ν΄λΌμ΄μ–ΈνΈκ°€ μ„λ²„μ— μ”μ²­μ„ λ³΄λ‚Ό λ• λ§λ‹¤ Basic64λ΅ μ•”νΈν™”ν• μ μ € μ •λ³΄λ¥Ό Request Headerμ— λ„£μ–΄ λ³΄λ‚΄κ² λλ‹¤.

 μ΄ μΈμ¦ λ°©λ²•μ€ κ°€λ³κ³  λΉ λ¥΄μ§€λ§ ν΄λΌμ΄μ–ΈνΈκ°€ μ”μ²­μ„ λ³΄λ‚Όλ•λ§λ‹¤ Request Headerμ— λ°μ΄ν„°λ¥Ό μ „μ†΅ν•΄μ„ λ³΄λ‚΄λ―€λ΅ logoutμ„ μ‹ν‚¬ λ°©λ²•μ΄ μ—†λ‹¤λ” λ‹¨μ μ΄ μλ‹¤.

Spring Securityμ—μ„λ” HttpSecurity.httpBasic()μ„ ν†µν•΄ ν™μ„±ν™” μ‹ν‚¬ μ μλ‹¤.

## π“— Form Based Auth

![Untitled](https://user-images.githubusercontent.com/19809346/140945583-bb4dac23-4891-4dc6-9c52-5f219b285b5c.png)
λ‹¤μκ³Ό κ°™μ€ μμ„λ΅ μ§„ν–‰λλ‹¤.

1. ν΄λΌμ΄μ–ΈνΈκ°€ μμ‹ μ μ •λ³΄λ¥Ό POST λ°©μ‹μΌλ΅ λ³΄λ‚Έλ‹¤.
2. μ„λ²„λ” μ •λ³΄κ°€ λ§λ”μ§€ ν™•μΈν•κ³  λ§λ‹¤λ©΄ OK λ©”μ‹μ§€μ™€ μ„Έμ… μ •λ³΄λ¥Ό λ³΄λ‚Έλ‹¤.
3. ν΄λΌμ΄μ–ΈνΈλ” μμ‹ μ μ •λ³΄λ¥Ό λ³΄λ‚Όλ•λ§λ‹¤ SessionIDλ¥Ό ν•¨κ» λ³΄λ‚Έλ‹¤.
4. μ„λ²„λ” μ„Έμ… μ•„μ΄λ””λ¥Ό κ²€μ¦ν•κ³  λ§λ‹¤λ©΄ 200 OK μƒνƒ λ©”μ‹μ§€λ¥Ό λ³΄λ‚Έλ‹¤.

 κ°€μ¥ λ§μ΄ μ“°μ΄λ” μΈμ¦ λ°©λ²•μΌλ΅ Sessionμ„ ν™μ©ν•λ” λ°©λ²•μ΄λ‹¤. μ΄λ¦„μ—μ„ μ• μ μλ“―μ΄ Formμ„ μ‚¬μ©ν•΄μ„ μΈμ¦μ„ ν•λ” λ°©μ‹μ΄λ©° μ„λ²„μΈ΅μ—μ„ κ°€μ§€κ³  μλ” μ„Έμ… μ •λ³΄λ¥Ό μ§€μ›€μΌλ΅μ¨ λ΅κ·Έμ•„μ›ƒλ„ κ°€λ¥ν•λ‹¤.

μ¤ν”„λ§ μ‹νλ¦¬ν‹°μ—μ„λ” HttpSecurity.authorizeRequests()λ¥Ό ν†µν•΄ ν™μ„±ν™” μ‹ν‚¬ μ μλ‹¤.

κ°κ°μ μΈμ¦μ€ HTTPSλ¥Ό μ‚¬μ©ν•λ”κ²ƒμ„ κ¶μ¥ν•λ‹¤. μ—¬μ κ°€ λλ‹¤λ©΄ HTTPSλ¥Ό μ‚¬μ©ν•μ.

## π“—CSRF(CROSS-SITE Request Forgery)

![csrf](https://user-images.githubusercontent.com/19809346/140945584-fbb08c64-833f-45d0-9752-b0d283017062.png)
μ›Ή μ• ν”λ¦¬μΌ€μ΄μ… μ·¨μ•½μ  μ¤‘ ν•λ‚λ΅, μ΄μ©μκ°€ μλ„ν•μ§€ μ•μ€ μ”μ²­μ„ ν†µν• κ³µκ²©μ„ μλ―Έν•λ‹¤.

μ΄κ±΄ μΆ€ λ” μ •λ¦¬ν•΄μ•Όν• λ“― π…
